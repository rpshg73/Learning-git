Version 1 code here.